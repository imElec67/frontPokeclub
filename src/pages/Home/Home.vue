<template>
  <div class="homeContainer">
    <Header />
    <main>
      <section id="heroSection" aria-label="Hero">
        <div class="particlesContainer">
          <span
            v-for="n in particleCount"
            :key="'hero-' + n"
            class="particle"
            ref="particlesRefsHero"
          />
        </div>
        <div class="heroContent">
          <h1 class="heroTitle">Bienvenue chez Pok√©Club</h1>
          <h1 class="heroTitleEffect">Bienvenue chez Pok√©Club</h1>
          <h2 class="heroSubtitle">Chope du Pok√©mon sans te ruiner ! Rejoins des fans et des d√©veloppeurs qui partagent toutes les p√©pites !</h2>
          <p class="heroDescription">Le groupe discord de Pok√©Club est fait pour toi, avec son Offre premium √† seulement 5,99‚Ç¨/mois sans engagement : r√©assorts, sorties, actus exclusives et entraide entre fans ‚Äî tout est r√©uni pour ne plus rien rater !</p>
        </div>
        <div class="arrowDown" @click="scrollToSection('avantages')">
          <i class="fa-solid fa-arrow-down"></i>
        </div>
        <div class="smoke smoke1"></div>
        <div class="smoke smoke2"></div>
        <div class="smoke smoke3"></div>
      </section>

      <section id="avantages" class="section">
        <div class="titleWrapper">
          <h2 class="sectionTitle">Avantages</h2>
          <h2 class="sectionTitleEffect">Avantages</h2>
        </div>
        <div class="avantagesContainer">
          <div class="avantagesImage">
            <img src="@/assets/avantagesPicture.png" alt="Avantages background" />
            <div class="avantageBox"
              v-for="(avantage, index) in avantages"
              :key="index"
              :style="avantage.style"
              :class="{ 'modern': avantage.look === 'modern', 'green': avantage.look === 'green' }">
              <i :class="avantage.icon"></i>
              <p class="avantageText">{{ avantage.text }}</p>
            </div>
          </div>
        </div>
      </section>

      <section id="offres" class="section">
        <div class="titleWrapper">
          <h2 class="sectionTitle">NOS OFFRES</h2>
          <h2 class="sectionTitleEffect">NOS OFFRES</h2>
        </div>
        <div class="offresContainer">
          <div class="offreBox free">
            <h3>Gratuit</h3>
            <ul>
              <li>
                <i class="fa-solid fa-circle-check" style="margin-right: 10px;"></i> Acc√®s aux sections gratuites de notre groupe Discord pour toujours</li>
              <li>
                <i class="fa-solid fa-circle-check" style="margin-right: 10px;"></i> Alertes avec d√©lais sur les nouvelles sorties, r√©assort</li>
              <li>
                <i class="fa-solid fa-circle-check" style="margin-right: 10px;"></i> Actualit√©s Pok√©mon centralis√©es : jeux, cartes, produits, √©v√©nements</li>
              <li>
                <i class="fa-solid fa-circle-check" style="margin-right: 10px;"></i> Achat, vente et √©change entre membres</li>
              <li>
                <i class="fa-solid fa-circle-check" style="margin-right: 10px;"></i> Une communaut√© active de passionn√©s comme toi !</li>
            </ul>
            <button class="joinButton">Rejoins le club Gratuit !</button>
          </div>
          <div class="offreBox premium">
            <h3>Premium</h3>
            <ul>
              <li>
                <i class="fa-solid fa-circle-check" style="margin-right: 10px;"></i> Alertes instantan√©es sans aucun d√©lai ‚Äî sois le premier √† choper les bons plans !</li>
              <li>
                <i class="fa-solid fa-circle-check" style="margin-right: 10px;"></i> Acc√®s exclusif au channel premium avec toutes les actu Pok√©mon en avant-premi√®re</li>
              <li>
                <i class="fa-solid fa-circle-check" style="margin-right: 10px;"></i> Support 24h/24, 7j/7 pour t'accompagner dans ta chasse ou tes achats</li>
              <li>
                <i class="fa-solid fa-circle-check" style="margin-right: 10px;"></i> Avantages sp√©ciaux r√©serv√©s aux membres premium</li>
              <li>
                <i class="fa-solid fa-circle-check" style="margin-right: 10px;"></i> Achat, vente et √©change entre membres premium filtr√©s</li>
              <li>
                <i class="fa-solid fa-circle-check" style="margin-right: 10px;"></i> Et bien plus encore √† d√©couvrir en rejoignant le Club !</li>
            </ul>
            <h4>Prix 5,99‚Ç¨/mois seulement avec 7 jours d'essai gratuit !</h4>
            <button class="joinButton premium">Rejoins le club premium !</button>
          </div>
        </div>
        <div class="smoke smoke1"></div>
        <div class="smoke smoke2"></div>
        <div class="smoke smoke3"></div>
      </section>

      <section id="succes" class="section">
        <div class="titleWrapper">
          <h2 class="sectionTitle">SUCC√àS</h2>
          <h2 class="sectionTitleEffect">SUCC√àS</h2>
        </div>
        <div class="succesContainer">
          <div class="succesImages">
            <img v-for="(image, index) in successImages"
                 :key="index"
                 :src="image.src"
                 :alt="image.alt"
                 :style="image.style"
                 class="succesImage" />
          </div>
        </div>
        <div class="succesContent">
          <div class="blurOverlay"></div>
          <div class="contentWrapper">
            <div class="succesContentTitleWrapper">
              <div class="titleWrapper wrapperContent">
                <h3 class="succesContentTitle">+500</h3>
                <h3 class="succesContentTitleEffect">+500</h3>
              </div>
            </div>
            <div class="succesText">
              <h4>Gr√¢ce √† Pok√©Club, notre communaut√© a d√©j√† profit√© de sorties exclusives, r√©assorts et ventes Pok√©mon.</h4>
              <p>Qu'attends-tu pour nous rejoindre et ne plus jamais passer √† c√¥t√© ?</p>
            </div>
          </div>
        </div>
      </section>

      <section id="avis" class="section">
        <div class="titleWrapper">
          <h2 class="sectionTitle">Avis !</h2>
          <h2 class="sectionTitleEffect">Avis !</h2>
        </div>
        <p class="sectionSubtitle">Ils en parlent mieux que nous : d√©couvre les avis de la communaut√© !</p>
        <div class="avisContainer">
          <swiper
            :modules="[SwiperNavigation, SwiperPagination]"
            :slides-per-view="3"
            :space-between="20"
            :navigation="{
              nextEl: '.swiper-button-next',
              prevEl: '.swiper-button-prev'
            }"
            :pagination="{
              clickable: true,
              el: '.swiper-pagination',
              type: 'bullets'
            }"
            :breakpoints="{
              320: {
                slidesPerView: 1,
                spaceBetween: 10
              },
              768: {
                slidesPerView: 2,
                spaceBetween: 15
              },
              1024: {
                slidesPerView: 3,
                spaceBetween: 20
              }
            }"
            class="reviewsSwiper"
          >
            <swiper-slide v-for="(review, index) in reviews" :key="index">
              <div class="reviewCard">
                <div class="reviewCardHeader">
                  <div class="reviewImage">
                    <img v-if="review.avatar" :src="review.avatar" :alt="review.name">
                    <div v-else class="fallbackAvatar">{{ review.name.charAt(0) }}</div>
                  </div>
                  <h3 class="reviewName">{{ review.name }}</h3>
                </div>
                <p class="reviewText">{{ review.text }}</p>
              </div>
            </swiper-slide>
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-pagination"></div>
          </swiper>
        </div>
      </section>

      <section id="faq" class="section">
        <div class="titleWrapper">
          <h2 class="sectionTitle">FAQ</h2>
          <h2 class="sectionTitleEffect">FAQ</h2>
        </div>
        <div class="faqContainer">
          <div v-for="(item, index) in faqItems" :key="index" class="faqItem" :class="{ 'open': item.isOpen }">
            <div class="faqQuestion" @click="toggleFaq(index)">
              <h3>{{ item.question }}</h3>
              <button class="toggleButton" :aria-label="item.isOpen ? 'Fermer' : 'Ouvrir'">
                <span class="toggleIcon"></span>
              </button>
            </div>
            <div class="faqAnswer" v-show="item.isOpen">
              <p>{{ item.answer }}</p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div class="footerContent">
        <p class="copyright">¬© 2025 Pok√©Club</p>
        <a href="#" class="terms" @click.prevent="showTermsModal = true">Terms & Condition</a>
      </div>
    </footer>

    <!-- Terms & Conditions Modal -->
    <div v-if="showTermsModal" class="modal-overlay" @click="showTermsModal = false">
      <div class="modal-content" @click.stop>
        <div class="modal-header">
          <h2>Terms & Conditions</h2>
          <button class="close-button" @click="showTermsModal = false">
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>
        <div class="modal-body">
          <h3>√âditeur du site</h3>
          <p>Pseudo: Xzile</p>
          <p>Adresse e-mail : pokeclub.communiction@gmail.com</p>

          <h3>H√©bergeur</h3>
          <p>H√©bergeur : [Nom de l'h√©bergeur]</p>
          <p>Adresse : [Adresse de l'h√©bergeur]</p>
          <p>T√©l√©phone : [Num√©ro de t√©l√©phone de l'h√©bergeur]</p>
          <p>Site Web : [URL de l'h√©bergeur]</p>

          <h3>Propri√©t√© intellectuelle</h3>
          <p>L'ensemble des contenus pr√©sents sur le site (textes, images, graphismes, logos, ic√¥nes, etc.) sont prot√©g√©s par le droit de la propri√©t√© intellectuelle. Toute reproduction, distribution, modification ou adaptation, totale ou partielle, est interdite sans l'accord √©crit pr√©alable de l'√©diteur.</p>

          <h3>Limitations de responsabilit√©</h3>
          <p>Le site ne saurait √™tre tenu responsable des erreurs rencontr√©es sur le site, probl√®mes techniques, interpr√©tation des informations publi√©es, ou cons√©quences de leur utilisation.</p>

          <h4>Website made by <a href="https://affluencestore.fr" target="_blank">Elec</a></h4>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import Header from '@/components/Header/Header.vue'
import { ref, computed, onMounted, onUnmounted, nextTick } from 'vue'
import { Swiper, SwiperSlide } from 'swiper/vue'
import { Navigation as SwiperNavigation, Pagination as SwiperPagination } from 'swiper/modules'
import 'swiper/css'
import 'swiper/css/navigation'
import 'swiper/css/pagination'

// Add Font Awesome CDN
const fontAwesomeLink = document.createElement('link')
fontAwesomeLink.rel = 'stylesheet'
fontAwesomeLink.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css'
document.head.appendChild(fontAwesomeLink)

const scrollToSection = (sectionId) => {
  const element = document.getElementById(sectionId)
  if (element) {
    const headerOffset = 80 // Height of the header
    const elementPosition = element.getBoundingClientRect().top
    const offsetPosition = elementPosition + window.pageYOffset - headerOffset

    window.scrollTo({
      top: offsetPosition,
      behavior: 'smooth'
    })
  }
}

const avantages = [
  { icon: "fa-solid fa-newspaper", text: "Actus Pok√©mon exclusives", style: { top: '10%', left: '-10%' }, look: "green" },
  { icon: "fa-solid fa-box-open", text: "Neuf & occasion", style: { top: '0%', right: '22%' }, look: "green" },
  { icon: "fa-solid fa-cart-shopping", text: "Achats, ventes et recherches centralis√©s", style: { top: '20%', right: '5%' }, look: "modern" },
  { icon: "fa-solid fa-users", text: "Une √©quipe de d√©veloppeurs passionn√©s", style: { top: '45%', left: '-15%' }, look: "modern" },
  { icon: "fa-solid fa-mobile-screen-button", text: "Alertes ultra rapides sur mobile et Pc", style: { top: '50%', right: '8%' }, look: "green" },
  { icon: "fa-solid fa-store", text: "Veille continue sur les boutiques sp√©cialis√©es", style: { top: '80%', left: '-5%' }, look: "green" },
  { icon: "fa-solid fa-coins", text: "Alertes sur le march√© de l'occasion", style: { top: '90%', right: '18%' }, look: "modern" }
]

const faqItems = ref([
  {
    question: "Puis-je r√©silier quand je veux ?",
    answer: "Oui, vous pouvez r√©silier votre abonnement √† tout moment directement depuis votre espace client.",
    isOpen: true
  },
  {
    question: "Y a-t-il un engagement ?",
    answer: "Non, l'abonnement est sans engagement. Vous √™tes libre de rester aussi longtemps que vous le souhaitez !",
    isOpen: true
  },
  {
    question: "Que comprend l'abonnement √† 5,99‚Ç¨ ?",
    answer: "L'acc√®s complet aux channels priv√©s, alertes en temps r√©els, actus, marketplace premium ‚Ä¶",
    isOpen: true
  },
  {
    question: "Comment puis-je acc√©der au contenu apr√®s mon achat ?",
    answer: "D√®s votre inscription, vous recevrez automatiquement vos acc√®s sur notre serveur Discord.",
    isOpen: true
  },
  {
    question: "Comment contacter le support si j'ai un probl√®me ?",
    answer: "Vous pouvez nous contacter directement via le support Discord 24/24 et 7/7 !",
    isOpen: true
  },
  {
    question: "Pourquoi uniquement 5,99‚Ç¨/mois ?",
    answer: "Nous avons voulu rendre Pok√©Club Premium accessible √† tous les fans de Pok√©mon sans d√©penser une fortune !",
    isOpen: true
  }
])

const toggleFaq = (index) => {
  faqItems.value[index].isOpen = !faqItems.value[index].isOpen
}

const reviews = [
  {
    name: "Big-Planet26",
    avatar: "https://img-v2-prod.whop.com/unsafe/rs:fit:96:0/plain/https%3A%2F%2Fcdn.discordapp.com%2Favatars%2F414572650803888139%2F0afb582372ec7e59e1975ec1f707ad53",
    text: "Gr√¢ce √† Pok√©Club, j'ai pu obtenir tous les coffrets que je voulais, sans rater une seule sortie. Entre les conseils des membres et les outils propos√©s, j'ai toujours √©t√© bien accompagn√©. Un grand merci √† toute l'√©quipe Pok√©Club !"
  },
  {
    name: "Atmos",
    avatar: "https://img-v2-prod.whop.com/unsafe/rs:fit:96:0/plain/https%3A%2F%2Fcdn.discordapp.com%2Favatars%2F419604783461302273%2Fa_a3a1cf6a57a02e3e9f7267025cc0d993",
    text: "Super serveur pour se retrouver entre passionn√©s Pok√©mon ! Le staff est disponible et tr√®s comp√©tant pour vous aider √† obtenir les items de vos r√™ves. Merci d'avoir cr√©e cette communaut√© !"
  },
  {
    name: "Saphism",
    avatar: "https://img-v2-prod.whop.com/unsafe/rs:fit:96:0/plain/https%3A%2F%2Fcdn.discordapp.com%2Favatars%2F283606683609989120%2Ff8e8eb3a2d94d91ab3883339a5e0fffb",
    text: "Certainement le meilleur groupe pour les passionn√©s Pok√©mon ! Un staff super disponible et tres competent qui met a jour tous les outils nous permettant de facilement suivre l'acualit√© et obtenir les sorties les plus compliqu√©s. Merci encore üôè"
  },
  {
    name: "elec",
    avatar: "https://img-v2-prod.whop.com/unsafe/rs:fit:96:0/plain/https%3A%2F%2Fcdn.discordapp.com%2Favatars%2F529082579744194580%2Fa_7d10f91c6b2b2e24acae42ca3350af46",
    text: "Le meilleur serveur pour les collectionneurs de cartes Pok√©mon ! Un espace d'√©change entre passionn√©s, avec de nombreux outils pratiques comme l'automatisation des annonces de stock. Parfait pour rester inform√© en temps r√©el des nouvelles sorties. Que vous cherchiez √† enrichir votre collection ou simplement discuter avec d'autres passionn√©s, vous y trouverez votre place !"
  },
  {
    name: "kmZ",
    avatar: "",
    text: "Communaut√© incroyable ! Fait par des passionn√©s pour les passionn√©s. Gr√¢ce √† Pok√©club tu obtiendras les coffrets et les cartes que tu cherches √† des bons prix ! Merci Pok√©club üèÜ"
  },
  {
    name: "maximetrevet",
    avatar: "",
    text: "Superbe communaut√© avec de vrais passionn√©s qui donnent tout pour nous faire obtenir ce qu'on veut : les outils √† dispos sont d'une qualit√© parfaite. H√¢te de d√©couvrir la suite avec la commu Pokeclub !"
  },
  {
    name: "Eren",
    avatar: "https://img-v2-prod.whop.com/unsafe/rs:fit:96:0/plain/https%3A%2F%2Fcdn.discordapp.com%2Favatars%2F1295361609065299968%2Fe2087f5edd381dbc16e427912d4892b7",
    text: "Communaut√© tr√®s active, que des passionn√©s. L'Entraide est le mot d'ordre, il m'a jamais √©t√© aussi facile d'obtenir mes coffrets gr√¢ce aux outils performant mis √† notre disposition. Merci Pokeclub ‚ù§Ô∏è"
  },
  {
    name: "RedOctober",
    avatar: "https://img-v2-prod.whop.com/unsafe/rs:fit:96:0/plain/https%3A%2F%2Fcdn.discordapp.com%2Favatars%2F873839243024269332%2F06b4740b2ca0a206e2a06e22d876d965",
    text: "Meilleure commu pokemon fran√ßaise et de loin! Pok√©club m'a vraiment aid√© √† obtenir tous les coffrets que je voulais sans exception que ce soit gr√¢ce aux conseils des autres membres ou gr√¢ce aux outils mis √† disposition. Merci encore Pok√©club!"
  }
]

const showTermsModal = ref(false)

const successImages = [
  {
    src: "/src/assets/successPicture1.jpg",
    alt: "Succ√®s 1",
    style: { top: '3%', left: '0%', zIndex: 2 }
  },
  {
    src: "/src/assets/successPicture2.jpg",
    alt: "Succ√®s 2",
    style: { top: '0%', left: '230px', zIndex: 0 }
  },
  {
    src: "/src/assets/successPicture3.jpg",
    alt: "Succ√®s 3",
    style: { top: '4%', left: '460px', zIndex: 1 }
  },
  {
    src: "/src/assets/successPicture4.jpg",
    alt: "Succ√®s 4",
    style: { top: '2%', left: '680px', zIndex: 2 }
  },
  {
    src: "/src/assets/successPicture5.jpg",
    alt: "Succ√®s 5",
    style: { top: '0%', left: '900px', zIndex: 0 }
  }
]

const particleCount = 20
const particlesRefsHero = ref([])
let animationFrameId
let velocitiesHero = []
let isVisible = true

function animateParticles(particles, velocities) {
  if (!isVisible) return

  particles.forEach((el, index) => {
    if (!el || !el.parentElement) return

    const container = el.parentElement.getBoundingClientRect()
    // Skip animation if container is not visible
    if (container.width === 0 || container.height === 0) return

    const particleWidth = el.offsetWidth
    const particleHeight = el.offsetHeight
    const maxX = container.width - particleWidth
    const maxY = container.height - particleHeight

    if (!el.style.left || !el.style.top) {
      el.style.left = `${Math.random() * maxX}px`
      el.style.top = `${Math.random() * maxY}px`
      const sizeMultiplier = 0.5 + Math.random() * 1.5
      el.style.transform = `scale(${sizeMultiplier})`
    }

    let left = parseFloat(el.style.left)
    let top = parseFloat(el.style.top)

    left += velocities[index].x
    top += velocities[index].y

    if (left <= 0 || left >= maxX) {
      velocities[index].x *= -1
      left = Math.max(0, Math.min(left, maxX))
    }

    if (top <= 0 || top >= maxY) {
      velocities[index].y *= -1
      top = Math.max(0, Math.min(top, maxY))
    }

    el.style.left = `${left}px`
    el.style.top = `${top}px`
  })
}

const startAnimation = () => {
  const baseSpeed = 1.5 / 5

  velocitiesHero = Array.from({ length: particleCount }, () => ({
    x: (Math.random() - 0.5) * baseSpeed,
    y: (Math.random() - 0.5) * baseSpeed
  }))

  const animate = () => {
    animateParticles(particlesRefsHero.value, velocitiesHero)
    animationFrameId = requestAnimationFrame(animate)
  }

  animate()
}

// Add visibility change detection
const handleVisibilityChange = () => {
  isVisible = !document.hidden
}

onMounted(async () => {
  document.addEventListener('visibilitychange', handleVisibilityChange)
  await nextTick()
  startAnimation()
})

onUnmounted(() => {
  document.removeEventListener('visibilitychange', handleVisibilityChange)
  cancelAnimationFrame(animationFrameId)
})
</script>

<style scoped lang="scss">
@use './Home.scss' as *;
@use '@/variables.scss' as *;

#heroSection {
  .particlesContainer {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    z-index: 0;
    overflow: hidden;
    border-radius: inherit;
  }

  .particle {
    position: absolute;
    width: 4.8px; // Reduced by 20% from 6px
    height: 4.8px; // Reduced by 20% from 6px
    background: $textColorPop;
    border-radius: 50%;
    opacity: 0.3;
    z-index: 0;
  }
}

.avisContainer {
  max-width: 1200px;
  margin: 0 auto;
  position: relative;
  overflow: hidden;
  padding: 0 50px;
}

:deep(.swiper) {
  padding: 10px 0;
  padding-bottom: 50px;
  width: 100%;
  position: relative;
}

:deep(.swiper-wrapper) {
  width: 100%;
}

:deep(.swiper-slide) {
  width: 100%;
  height: auto;
}

:deep(.swiper-button-next),
:deep(.swiper-button-prev) {
  color: $textColorPop;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 1px solid rgba(229, 193, 137, 0.6);
  width: 40px;
  height: 40px;
  border-radius: 50%;
  top: 50%;
  transform: translateY(-50%);
  z-index: 100;

  &:after {
    font-size: 18px;
  }

  &:hover:not(.swiper-button-disabled) {
    background: rgba(255, 255, 255, 0.2);
    transform: translateY(-50%) scale(1.1);
  }

  &.swiper-button-disabled {
    opacity: 0.5;
  }
}

:deep(.swiper-button-next) {
  right: 0;
}

:deep(.swiper-button-prev) {
  left: 0;
}

:deep(.swiper-pagination) {
  position: relative;
  bottom: 0;
  margin-top: 20px;
  display: flex;
  justify-content: center;
  gap: 8px;

  .swiper-pagination-bullet {
    width: 8px;
    height: 8px;
    background: rgba(229, 193, 137, 0.3);
    opacity: 1;
    margin: 0;

    &:hover {
      background: rgba(229, 193, 137, 0.5);
    }
  }

  .swiper-pagination-bullet-active {
    background: $textColorPop;
  }
}
</style>